"use strict";(self.webpackChunkbrain_power=self.webpackChunkbrain_power||[]).push([[9797],{9797:(G,u,g)=>{g.r(u),g.d(u,{MemoryGameComponent:()=>k});var p=g(177),f=g(3025),v=g(9112),e=g(4438),m=g(70),b=g(5096),_=g(8490);function w(a,c){if(1&a){const t=e.RV6();e.j41(0,"div",11)(1,"button",12),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.selectLevel("beginner"))}),e.j41(2,"span",13),e.EFF(3),e.nI1(4,"t"),e.k0s()(),e.j41(5,"button",12),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.selectLevel("advanced"))}),e.j41(6,"span",14),e.EFF(7),e.nI1(8,"t"),e.k0s()(),e.j41(9,"button",12),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.selectLevel("grand"))}),e.j41(10,"span",15),e.EFF(11),e.nI1(12,"t"),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(),e.AVh("selected","beginner"===t.level),e.R7$(2),e.JRh(e.bMT(4,9,"beginner")),e.R7$(2),e.AVh("selected","advanced"===t.level),e.R7$(2),e.JRh(e.bMT(8,11,"advanced")),e.R7$(2),e.AVh("selected","grand"===t.level),e.R7$(2),e.JRh(e.bMT(12,13,"grand_master"))}}function x(a,c){1&a&&e.nrm(0,"div",24),2&a&&e.xc7("background-color",c.$implicit.color)}function M(a,c){if(1&a&&(e.j41(0,"div",22),e.DNE(1,x,1,2,"div",23),e.k0s()),2&a){const t=c.$implicit;e.R7$(),e.Y8G("ngForOf",t)}}function C(a,c){if(1&a&&(e.j41(0,"div",16)(1,"div",17)(2,"h2"),e.EFF(3),e.nI1(4,"t"),e.k0s(),e.j41(5,"p",18),e.EFF(6),e.nI1(7,"t"),e.j41(8,"strong"),e.EFF(9),e.k0s(),e.EFF(10),e.nI1(11,"t"),e.k0s()(),e.j41(12,"div",19),e.DNE(13,M,2,1,"div",20),e.k0s(),e.j41(14,"p",21),e.EFF(15),e.nI1(16,"t"),e.k0s()()),2&a){const t=e.XpG();e.R7$(3),e.JRh(e.bMT(4,8,"memorize_pattern")),e.R7$(3),e.SpI("",e.bMT(7,10,"pattern_will_hide_in")," "),e.R7$(3),e.JRh(t.getRemainingViewTime()),e.R7$(),e.SpI(" ",e.bMT(11,12,"seconds"),""),e.R7$(2),e.xc7("grid-template-columns","repeat("+t.gridCols+", 1fr)"),e.R7$(),e.Y8G("ngForOf",t.patternGrid),e.R7$(2),e.JRh(e.bMT(16,14,"watch_carefully_pattern"))}}function P(a,c){if(1&a&&e.nrm(0,"div",31),2&a){const t=c.$implicit,n=c.index,o=e.XpG().index;e.xc7("background-color",t.color||"#2a2a2a"),e.AVh("filled",t.isPlaced),e.BMQ("data-row",o)("data-col",n)}}function y(a,c){if(1&a&&(e.j41(0,"div",22),e.DNE(1,P,1,6,"div",30),e.k0s()),2&a){const t=c.$implicit;e.R7$(),e.Y8G("ngForOf",t)}}function E(a,c){if(1&a){const t=e.RV6();e.j41(0,"div",32),e.bIt("mousedown",function(o){const i=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.onPieceMouseDown(o,i))})("touchstart",function(o){const i=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.onPieceTouchStart(o,i))}),e.k0s()}if(2&a){const t=c.$implicit,n=e.XpG(2);e.xc7("background-color",t.color)("cursor","playing"===n.phase?"grab":"not-allowed"),e.BMQ("draggable",!1)}}function O(a,c){if(1&a&&(e.j41(0,"div",16)(1,"div",17)(2,"h2"),e.EFF(3),e.nI1(4,"t"),e.k0s(),e.j41(5,"p",21),e.EFF(6),e.nI1(7,"t"),e.k0s()(),e.j41(8,"div",25)(9,"div",26),e.EFF(10),e.nI1(11,"t"),e.k0s(),e.j41(12,"div",19),e.DNE(13,y,2,1,"div",20),e.k0s()(),e.j41(14,"div",27)(15,"div",26),e.EFF(16),e.nI1(17,"t"),e.k0s(),e.j41(18,"div",28),e.DNE(19,E,1,5,"div",29),e.k0s()()()),2&a){const t=e.XpG();e.R7$(3),e.JRh(e.bMT(4,13,"recreate_pattern")),e.R7$(3),e.JRh(e.bMT(7,15,"drag_pieces_to_grid")),e.R7$(4),e.JRh(e.bMT(11,17,"your_pattern")),e.R7$(2),e.xc7("grid-template-columns","repeat("+t.gridCols+", 1fr)"),e.AVh("grid-4-col",4===t.gridCols),e.R7$(),e.Y8G("ngForOf",t.userGrid),e.R7$(3),e.JRh(e.bMT(17,19,"available_pieces")),e.R7$(2),e.AVh("grid-2-col",2===t.gridCols),e.R7$(),e.Y8G("ngForOf",t.availablePieces)("ngForTrackBy",t.trackByPieceId)}}function T(a,c){if(1&a){const t=e.RV6();e.j41(0,"div",33)(1,"div",34)(2,"div",35),e.EFF(3,"\u{1f389}"),e.k0s(),e.j41(4,"h2"),e.EFF(5),e.nI1(6,"t"),e.k0s(),e.j41(7,"p",36),e.EFF(8),e.nI1(9,"t"),e.k0s(),e.j41(10,"div",37)(11,"button",38),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.restartGame())}),e.EFF(12),e.nI1(13,"t"),e.k0s(),e.j41(14,"button",39),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.goBack())}),e.EFF(15),e.nI1(16,"t"),e.k0s()()()()}2&a&&(e.R7$(5),e.JRh(e.bMT(6,4,"congratulations")),e.R7$(3),e.JRh(e.bMT(9,6,"pattern_matched")),e.R7$(4),e.SpI(" ",e.bMT(13,8,"play_again")," "),e.R7$(3),e.SpI(" ",e.bMT(16,10,"back_to_activities")," "))}function D(a,c){if(1&a){const t=e.RV6();e.j41(0,"div",40)(1,"div",34)(2,"div",35),e.EFF(3,"\u{1f614}"),e.k0s(),e.j41(4,"h2"),e.EFF(5),e.nI1(6,"t"),e.k0s(),e.j41(7,"p",41),e.EFF(8),e.nI1(9,"t"),e.k0s(),e.j41(10,"div",37)(11,"button",38),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.restartGame())}),e.EFF(12),e.nI1(13,"t"),e.k0s(),e.j41(14,"button",39),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.goBack())}),e.EFF(15),e.nI1(16,"t"),e.k0s()()()()}2&a&&(e.R7$(5),e.JRh(e.bMT(6,4,"not_quite_right")),e.R7$(3),e.JRh(e.bMT(9,6,"pattern_mismatch")),e.R7$(4),e.SpI(" ",e.bMT(13,8,"try_again")," "),e.R7$(3),e.SpI(" ",e.bMT(16,10,"back_to_activities")," "))}let k=(()=>{class a{constructor(t,n,o,i){this.router=t,this.route=n,this.translateService=o,this.dataService=i,this.level="beginner",this.showLevelDropdown=!1,this.phase="viewing",this.gridSize=2,this.gridRows=2,this.gridCols=2,this.viewDuration=5e3,this.patternGrid=[],this.userGrid=[],this.availablePieces=[],this.draggedPiece=null,this.isDragging=!1,this.dragOffset={x:0,y:0},this.draggedElement=null,this.dragStartTimer=null,this.dragStarted=!1,this.mouseDownPosition={x:0,y:0},this.currentDropZone=null,this.boundMouseMove=null,this.boundMouseUp=null,this.boundTouchMove=null,this.boundTouchEnd=null,this.remainingSeconds=0,this.colors=["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8","#F7DC6F","#BB8FCE","#85C1E2"],this.startTime=0,this.completionTime=0,this.score=0}ngOnInit(){this.route.queryParams.subscribe(t=>{const n=localStorage.getItem("level");this.level=t.level||("advanced"===n||"grand"===n?n:"beginner"),this.initializeGame()})}toggleLevelDropdown(){this.showLevelDropdown=!this.showLevelDropdown}onDocumentClick(t){!t.target.closest(".custom-dropdown")&&this.showLevelDropdown&&(this.showLevelDropdown=!1)}selectLevel(t){this.level!==t?(this.viewTimer&&clearTimeout(this.viewTimer),this.countdownInterval&&clearInterval(this.countdownInterval),this.level=t,this.showLevelDropdown=!1,this.phase="viewing",this.startTime=0,this.completionTime=0,this.score=0,this.remainingSeconds=0,this.initializeGame()):this.showLevelDropdown=!1}onLevelChange(t){this.selectLevel(t)}ngAfterViewInit(){setTimeout(()=>{this.updateDraggableAttributes()},100)}updateDraggableAttributes(){requestAnimationFrame(()=>{document.querySelectorAll(".draggable-piece").forEach(n=>{const o=n;"playing"===this.phase?(o.setAttribute("draggable","false"),o.style.cursor="grab"):(o.setAttribute("draggable","false"),o.style.cursor="not-allowed")})})}ngOnDestroy(){this.viewTimer&&clearTimeout(this.viewTimer),this.countdownInterval&&clearInterval(this.countdownInterval),this.dragStartTimer&&clearTimeout(this.dragStartTimer),this.boundMouseMove&&document.removeEventListener("mousemove",this.boundMouseMove,!0),this.boundMouseUp&&document.removeEventListener("mouseup",this.boundMouseUp,!0),this.boundTouchMove&&document.removeEventListener("touchmove",this.boundTouchMove,!0),this.boundTouchEnd&&document.removeEventListener("touchend",this.boundTouchEnd,!0),this.draggedElement&&this.draggedElement.remove()}initializeGame(){switch(this.level){case"beginner":this.gridRows=2,this.gridCols=2,this.viewDuration=5e3;break;case"advanced":this.gridRows=2,this.gridCols=3,this.viewDuration=1e4;break;case"grand":this.gridRows=2,this.gridCols=4,this.viewDuration=15e3}this.generatePattern(),this.initializeUserGrid(),this.generateAvailablePieces(),this.startViewingPhase()}generatePattern(){this.patternGrid=[];const t=[];let n;switch(this.level){case"beginner":n=["#E74C3C","#3498DB","#2ECC71","#FF9800"];break;case"advanced":n=["#E74C3C","#3498DB","#2ECC71","#FF9800","#9B59B6","#F1C40F"];break;case"grand":n=["#E74C3C","#3498DB","#2ECC71","#FF9800","#9B59B6","#F1C40F","#E91E63","#00BCD4"];break;default:n=this.colors}for(let s=0;s<this.gridRows;s++){this.patternGrid[s]=[];for(let l=0;l<this.gridCols;l++){const d=n[Math.floor(Math.random()*n.length)];t.push(d),this.patternGrid[s][l]={row:s,col:l,color:d,isPlaced:!0}}}const o=[...new Set(t)],r=Math.min(3,this.gridRows*this.gridCols);o.length<r&&this.generatePattern()}initializeUserGrid(){this.userGrid=[];for(let t=0;t<this.gridRows;t++){this.userGrid[t]=[];for(let n=0;n<this.gridCols;n++)this.userGrid[t][n]={row:t,col:n,color:"",isPlaced:!1}}}generateAvailablePieces(){const t=[];this.patternGrid.forEach(o=>{o.forEach(i=>{t.push(i.color)})});const n=[...new Set(t)];this.availablePieces=[],n.forEach((o,i)=>{this.availablePieces.push({id:i,color:o,isUsed:!1})}),"beginner"!==this.level&&this.colors.filter(i=>!n.includes(i)).slice(0,2).forEach((i,r)=>{this.availablePieces.push({id:n.length+r,color:i,isUsed:!1})}),this.availablePieces=this.shuffleArray([...this.availablePieces])}shuffleArray(t){const n=[...t];for(let o=n.length-1;o>0;o--){const i=Math.floor(Math.random()*(o+1));[n[o],n[i]]=[n[i],n[o]]}return n}startViewingPhase(){this.phase="viewing",this.startTime=Date.now(),this.remainingSeconds=Math.ceil(this.viewDuration/1e3),this.countdownInterval=setInterval(()=>{this.remainingSeconds--,this.remainingSeconds<=0&&(clearInterval(this.countdownInterval),this.countdownInterval=null)},1e3),this.viewTimer=setTimeout(()=>{this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null),this.phase="playing",this.viewTimer=null,this.remainingSeconds=0,setTimeout(()=>{this.updateDraggableAttributes()},100)},this.viewDuration)}trackByPieceId(t,n){return n.id}onPieceMouseDown(t,n){if(0!==t.button||"playing"!==this.phase)return;t.preventDefault(),t.stopPropagation(),this.draggedPiece=n,this.dragStarted=!1,this.mouseDownPosition={x:t.clientX,y:t.clientY};const o=t.currentTarget;o&&(o.classList.add("press-hold"),this.boundMouseMove=i=>this.onMouseMove(i),this.boundMouseUp=i=>this.onMouseUp(i),document.addEventListener("mousemove",this.boundMouseMove,!0),document.addEventListener("mouseup",this.boundMouseUp,!0),this.dragStartTimer=setTimeout(()=>{o.classList.remove("press-hold"),this.startDraggingMouse(t,o)},100))}onPieceTouchStart(t,n){if("playing"!==this.phase)return;t.preventDefault(),t.stopPropagation();const o=t.touches[0];if(!o)return;this.draggedPiece=n,this.dragStarted=!1,this.mouseDownPosition={x:o.clientX,y:o.clientY};const i=t.currentTarget;i&&(i.classList.add("press-hold"),this.boundTouchMove=r=>this.onTouchMove(r),this.boundTouchEnd=r=>this.onTouchEnd(r),document.addEventListener("touchmove",this.boundTouchMove,{passive:!1,capture:!0}),document.addEventListener("touchend",this.boundTouchEnd,!0),this.dragStartTimer=setTimeout(()=>{i.classList.remove("press-hold"),this.startDraggingTouch(o,i)},100))}startDraggingMouse(t,n){if(!this.draggedPiece)return;this.isDragging=!0,this.dragStarted=!0,this.draggedElement=n.cloneNode(!0),this.draggedElement.style.position="fixed",this.draggedElement.style.pointerEvents="none",this.draggedElement.style.zIndex="10000",this.draggedElement.style.opacity="0.8",this.draggedElement.style.cursor="grabbing",this.draggedElement.style.transition="none",this.draggedElement.style.willChange="transform",this.draggedElement.querySelectorAll("*").forEach(l=>{l.style.pointerEvents="none",l.style.transition="none"});const i=n.getBoundingClientRect();this.dragOffset.x=this.mouseDownPosition.x-i.left,this.dragOffset.y=this.mouseDownPosition.y-i.top;const s=this.mouseDownPosition.y-this.dragOffset.y;this.draggedElement.style.left=this.mouseDownPosition.x-this.dragOffset.x+"px",this.draggedElement.style.top=s+"px",this.draggedElement.style.width=i.width+"px",this.draggedElement.style.height=i.height+"px",this.draggedElement.style.transform="scale(1.2)",document.body.appendChild(this.draggedElement),n.style.opacity="0.5"}startDraggingTouch(t,n){if(!this.draggedPiece)return;this.isDragging=!0,this.dragStarted=!0,this.draggedElement=n.cloneNode(!0),this.draggedElement.style.position="fixed",this.draggedElement.style.pointerEvents="none",this.draggedElement.style.zIndex="10000",this.draggedElement.style.opacity="0.8",this.draggedElement.style.cursor="grabbing",this.draggedElement.style.transition="none",this.draggedElement.style.willChange="transform",this.draggedElement.querySelectorAll("*").forEach(l=>{l.style.pointerEvents="none",l.style.transition="none"});const i=n.getBoundingClientRect();this.dragOffset.x=t.clientX-i.left,this.dragOffset.y=t.clientY-i.top;const s=t.clientY-this.dragOffset.y;this.draggedElement.style.left=t.clientX-this.dragOffset.x+"px",this.draggedElement.style.top=s+"px",this.draggedElement.style.width=i.width+"px",this.draggedElement.style.height=i.height+"px",this.draggedElement.style.transform="scale(1.2)",document.body.appendChild(this.draggedElement),n.style.opacity="0.5"}onMouseMove(t){if(!this.isDragging&&this.draggedPiece)return void(Math.sqrt(Math.pow(t.clientX-this.mouseDownPosition.x,2)+Math.pow(t.clientY-this.mouseDownPosition.y,2))>10&&this.cancelDrag());if(!this.isDragging||!this.draggedElement)return;t.preventDefault(),this.draggedElement.style.left=t.clientX-this.dragOffset.x+"px",this.draggedElement.style.top=t.clientY-this.dragOffset.y+"px";const n=document.querySelectorAll(".drop-zone");let o=null;n.forEach(i=>{const r=i.getBoundingClientRect();t.clientX>=r.left&&t.clientX<=r.right&&t.clientY>=r.top&&t.clientY<=r.bottom&&(o=i)}),o!==this.currentDropZone&&(this.currentDropZone&&this.currentDropZone.classList.remove("drag-over"),null!==o&&o.classList.add("drag-over"),this.currentDropZone=o)}onTouchMove(t){const n=t.touches[0];if(!n)return;if(!this.isDragging&&this.draggedPiece)return void(Math.sqrt(Math.pow(n.clientX-this.mouseDownPosition.x,2)+Math.pow(n.clientY-this.mouseDownPosition.y,2))>10&&this.cancelDrag());if(!this.isDragging||!this.draggedElement)return;t.preventDefault(),this.draggedElement.style.left=n.clientX-this.dragOffset.x+"px",this.draggedElement.style.top=n.clientY-this.dragOffset.y+"px";const o=document.querySelectorAll(".drop-zone");let i=null;o.forEach(r=>{const s=r.getBoundingClientRect();n.clientX>=s.left&&n.clientX<=s.right&&n.clientY>=s.top&&n.clientY<=s.bottom&&(i=r)}),i!==this.currentDropZone&&(this.currentDropZone&&this.currentDropZone.classList.remove("drag-over"),null!==i&&i.classList.add("drag-over"),this.currentDropZone=i)}cancelDrag(){this.dragStartTimer&&(clearTimeout(this.dragStartTimer),this.dragStartTimer=null),document.querySelectorAll(".draggable-piece.press-hold").forEach(t=>{t.classList.remove("press-hold")}),this.boundMouseMove&&(document.removeEventListener("mousemove",this.boundMouseMove,!0),this.boundMouseMove=null),this.boundMouseUp&&(document.removeEventListener("mouseup",this.boundMouseUp,!0),this.boundMouseUp=null),this.boundTouchMove&&(document.removeEventListener("touchmove",this.boundTouchMove,!0),this.boundTouchMove=null),this.boundTouchEnd&&(document.removeEventListener("touchend",this.boundTouchEnd,!0),this.boundTouchEnd=null),this.draggedPiece=null,this.dragStarted=!1,this.isDragging=!1}onMouseUp(t){if(t.preventDefault(),this.dragStartTimer&&(clearTimeout(this.dragStartTimer),this.dragStartTimer=null),document.querySelectorAll(".draggable-piece.press-hold").forEach(o=>{o.classList.remove("press-hold")}),this.boundMouseMove&&(document.removeEventListener("mousemove",this.boundMouseMove,!0),this.boundMouseMove=null),this.boundMouseUp&&(document.removeEventListener("mouseup",this.boundMouseUp,!0),this.boundMouseUp=null),!this.dragStarted||!this.isDragging)return this.draggedPiece=null,this.dragStarted=!1,void(this.isDragging=!1);if(this.draggedElement&&(this.draggedElement.remove(),this.draggedElement=null),document.querySelectorAll(".draggable-piece").forEach(o=>{"0.5"===o.style.opacity&&(o.style.opacity="1")}),this.draggedPiece){const o=document.querySelectorAll(".drop-zone");let i=null;if(o.forEach(r=>{const s=r.getBoundingClientRect();t.clientX>=s.left&&t.clientX<=s.right&&t.clientY>=s.top&&t.clientY<=s.bottom&&(i=r)}),null!==i){const r=i;r.classList.remove("drag-over");const s=parseInt(r.getAttribute("data-row")||"0"),l=parseInt(r.getAttribute("data-col")||"0");this.userGrid[s][l].color=this.draggedPiece.color,this.userGrid[s][l].isPlaced=!0,this.userGrid=[...this.userGrid],this.availablePieces=[...this.availablePieces],setTimeout(()=>{this.updateDraggableAttributes()},0),this.checkCompletion()}}this.currentDropZone&&(this.currentDropZone.classList.remove("drag-over"),this.currentDropZone=null),this.isDragging=!1,this.draggedPiece=null,this.dragStarted=!1}onTouchEnd(t){if(t.preventDefault(),this.dragStartTimer&&(clearTimeout(this.dragStartTimer),this.dragStartTimer=null),document.querySelectorAll(".draggable-piece.press-hold").forEach(i=>{i.classList.remove("press-hold")}),this.boundTouchMove&&(document.removeEventListener("touchmove",this.boundTouchMove,!0),this.boundTouchMove=null),this.boundTouchEnd&&(document.removeEventListener("touchend",this.boundTouchEnd,!0),this.boundTouchEnd=null),!this.dragStarted||!this.isDragging)return this.draggedPiece=null,this.dragStarted=!1,void(this.isDragging=!1);const n=t.changedTouches[0];if(n){if(this.draggedElement&&(this.draggedElement.remove(),this.draggedElement=null),document.querySelectorAll(".draggable-piece").forEach(i=>{"0.5"===i.style.opacity&&(i.style.opacity="1")}),this.draggedPiece){const i=document.querySelectorAll(".drop-zone");let r=null;if(i.forEach(s=>{const l=s.getBoundingClientRect();n.clientX>=l.left&&n.clientX<=l.right&&n.clientY>=l.top&&n.clientY<=l.bottom&&(r=s)}),null!==r){const s=r;s.classList.remove("drag-over");const l=parseInt(s.getAttribute("data-row")||"0"),d=parseInt(s.getAttribute("data-col")||"0");this.userGrid[l][d].color=this.draggedPiece.color,this.userGrid[l][d].isPlaced=!0,this.userGrid=[...this.userGrid],this.availablePieces=[...this.availablePieces],setTimeout(()=>{this.updateDraggableAttributes()},0),this.checkCompletion()}}this.currentDropZone&&(this.currentDropZone.classList.remove("drag-over"),this.currentDropZone=null),this.isDragging=!1,this.draggedPiece=null,this.dragStarted=!1}else this.cancelDrag()}onDragStart(t,n){return n.preventDefault(),!1}onDragEnd(t){}onDragEnter(t,n,o){t.preventDefault(),t.stopPropagation();const i=t.currentTarget;i&&i.classList.contains("drop-zone")&&!this.userGrid[n][o].isPlaced&&i.classList.add("drag-over")}onDragLeave(t,n,o){t.preventDefault();const i=t.currentTarget;i&&i.classList.contains("drop-zone")&&i.classList.remove("drag-over")}onDragOver(t,n,o){t.preventDefault(),t.stopPropagation(),t.dataTransfer&&(t.dataTransfer.dropEffect=this.userGrid[n][o].isPlaced?"none":"move");const i=t.currentTarget;i&&i.classList.contains("drop-zone")&&i.classList.add("drag-over")}onDrop(t,n,o){t.preventDefault(),t.stopPropagation();const i=t.currentTarget;i&&i.classList.remove("drag-over");let r=this.draggedPiece;if(!r&&t.dataTransfer)try{const s=t.dataTransfer.getData("application/json");if(s){const l=JSON.parse(s),d=this.availablePieces.find(h=>h.id===l.id);d&&(r=d)}}catch{const l=parseInt(t.dataTransfer.getData("text/plain"));if(!isNaN(l)){const d=this.availablePieces.find(h=>h.id===l);d&&(r=d)}}!r||"playing"!==this.phase||(this.userGrid[n][o].color=r.color,this.userGrid[n][o].isPlaced=!0,this.draggedPiece=null,this.userGrid=[...this.userGrid],this.availablePieces=[...this.availablePieces],setTimeout(()=>{this.updateDraggableAttributes()},0),this.checkCompletion())}removePiece(t,n){"playing"!==this.phase||!this.userGrid[t][n].isPlaced||(this.userGrid[t][n].color="",this.userGrid[t][n].isPlaced=!1)}checkCompletion(){if(!this.userGrid.every(r=>r.every(s=>s.isPlaced)))return;let n=0;for(let r=0;r<this.gridRows;r++)for(let s=0;s<this.gridCols;s++)this.userGrid[r][s].color===this.patternGrid[r][s].color&&n++;const i=n/(this.gridRows*this.gridCols);1===i?(this.completionTime=Date.now()-this.startTime,this.score=Math.max(0,1e3-Math.floor(this.completionTime/100)),this.phase="completed",this.markAsCompleted()):i>=.7?(this.completionTime=Date.now()-this.startTime,this.score=Math.max(0,Math.floor(1e3*i-Math.floor(this.completionTime/100))),this.phase="completed",this.markAsCompleted()):this.phase="failed"}markAsCompleted(){const t=Math.floor(this.completionTime/1e3),n={date:(new Date).toISOString().split("T")[0],exerciseId:"memory",level:this.level,durationSec:t,score:this.score};this.dataService.addCompletion(n)}restartGame(){this.initializeGame()}goBack(){this.router.navigate(["/lets-begin"])}getRemainingViewTime(){return this.remainingSeconds}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(m.Ix),e.rXU(m.nX),e.rXU(b.c),e.rXU(_.u))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-memory-game"]],hostBindings:function(n,o){1&n&&e.bIt("click",function(r){return o.onDocumentClick(r)},!1,e.EBC)},standalone:!0,features:[e.aNF],decls:21,vars:23,consts:[[3,"title"],[1,"content"],[1,"level-selector-container"],[1,"level-label"],[1,"custom-dropdown"],["type","button",1,"dropdown-toggle",3,"click"],[1,"dropdown-arrow","icon"],["class","dropdown-menu",4,"ngIf"],["class","game-container",4,"ngIf"],["class","game-container completed",4,"ngIf"],["class","game-container failed",4,"ngIf"],[1,"dropdown-menu"],["type","button",1,"dropdown-option",3,"click"],[1,"level-text","level-beginner"],[1,"level-text","level-advanced"],[1,"level-text","level-grand"],[1,"game-container"],[1,"phase-header"],[1,"countdown"],[1,"pattern-grid"],["class","pattern-row",4,"ngFor","ngForOf"],[1,"instruction-text"],[1,"pattern-row"],["class","pattern-cell",3,"background-color",4,"ngFor","ngForOf"],[1,"pattern-cell"],[1,"user-grid-container"],[1,"grid-label"],[1,"pieces-container"],[1,"pieces-grid"],["class","draggable-piece",3,"background-color","cursor","mousedown","touchstart",4,"ngFor","ngForOf","ngForTrackBy"],["class","pattern-cell drop-zone",3,"filled","background-color",4,"ngFor","ngForOf"],[1,"pattern-cell","drop-zone"],[1,"draggable-piece",3,"mousedown","touchstart"],[1,"game-container","completed"],[1,"completion-card"],[1,"completion-icon"],[1,"success-message"],[1,"button-group"],[1,"btn-primary",3,"click"],[1,"btn-secondary",3,"click"],[1,"game-container","failed"],[1,"error-message"]],template:function(n,o){1&n&&(e.nrm(0,"app-header",0),e.nI1(1,"t"),e.j41(2,"section",1)(3,"div",2)(4,"label",3),e.EFF(5),e.nI1(6,"t"),e.k0s(),e.j41(7,"div",4)(8,"button",5),e.bIt("click",function(){return o.toggleLevelDropdown()}),e.j41(9,"span"),e.EFF(10),e.nI1(11,"t"),e.nI1(12,"t"),e.nI1(13,"t"),e.k0s(),e.j41(14,"span",6),e.EFF(15,"expand_more"),e.k0s()(),e.DNE(16,w,13,15,"div",7),e.k0s()(),e.DNE(17,C,17,16,"div",8)(18,O,20,21,"div",8)(19,T,17,12,"div",9)(20,D,17,12,"div",10),e.k0s()),2&n&&(e.Y8G("title",e.bMT(1,13,"memory_game_image_patterns")),e.R7$(5),e.SpI("",e.bMT(6,15,"change_level"),":"),e.R7$(2),e.AVh("open",o.showLevelDropdown),e.R7$(),e.BMQ("data-level",o.level),e.R7$(),e.HbH("level-text level-"+o.level),e.R7$(),e.JRh("beginner"===o.level?e.bMT(11,17,"beginner"):"advanced"===o.level?e.bMT(12,19,"advanced"):e.bMT(13,21,"grand_master")),e.R7$(6),e.Y8G("ngIf",o.showLevelDropdown),e.R7$(),e.Y8G("ngIf","viewing"===o.phase),e.R7$(),e.Y8G("ngIf","playing"===o.phase),e.R7$(),e.Y8G("ngIf","completed"===o.phase),e.R7$(),e.Y8G("ngIf","failed"===o.phase))},dependencies:[p.MD,p.Sq,p.bT,f.y,v.Z],styles:[".content[_ngcontent-%COMP%]{padding:4vw clamp(12px,3vw,24px) clamp(12px,3vw,24px);max-width:min(800px,95vw);margin:3vw auto 0;min-height:calc(100vh - 100px);width:100%;box-sizing:border-box}.level-selector-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:16px;margin-bottom:24px;padding:16px 24px;background:linear-gradient(135deg,#ffffff26,#ffffff1a);backdrop-filter:blur(15px);border-radius:24px;border:2px solid rgba(255,255,255,.25);box-shadow:0 8px 32px #0003,0 2px 8px #0000001a,inset 0 1px #ffffff4d;transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;z-index:10000}.level-selector-container[_ngcontent-%COMP%]:hover{border-color:#fff6;box-shadow:0 12px 40px #00000040,0 4px 12px #00000026,inset 0 1px #fff6;transform:translateY(-2px)}.level-label[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:#fff;white-space:nowrap;text-shadow:0 2px 4px rgba(0,0,0,.3);letter-spacing:.5px}.custom-dropdown[_ngcontent-%COMP%]{position:relative;min-width:180px;z-index:99999}.dropdown-toggle[_ngcontent-%COMP%]{width:100%;padding:14px 48px 14px 20px;border:2px solid rgba(255,255,255,.4);border-radius:12px;background:linear-gradient(135deg,#fffffff2,#ffffffe6);color:#333;font-size:1.05rem;font-weight:700;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);display:flex;align-items:center;justify-content:space-between;box-shadow:0 4px 12px #00000026,inset 0 1px #fff3;text-align:center;min-height:50px}.dropdown-toggle[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#fff,#fffffff2);border-color:#fff9;box-shadow:0 6px 16px #0003;transform:translateY(-1px)}.dropdown-toggle[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 4px #d977064d,0 6px 20px #d9770666}.dropdown-arrow[_ngcontent-%COMP%]{font-size:20px;color:#666;transition:transform .3s ease,color .3s ease;display:inline-block;transform-origin:center}.custom-dropdown.open[_ngcontent-%COMP%]   .dropdown-arrow[_ngcontent-%COMP%]{transform:rotate(180deg)}.dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 4px);left:0;right:0;background:#fff;border-radius:16px;box-shadow:0 8px 32px #0006,0 4px 16px #0000004d;overflow:hidden;z-index:99999!important;border:2px solid rgba(0,0,0,.1);animation:_ngcontent-%COMP%_slideDown .3s ease}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.dropdown-option[_ngcontent-%COMP%]{width:100%;padding:16px 20px;border:none;background:transparent;color:#333;font-size:1.05rem;font-weight:600;cursor:pointer;transition:all .2s ease;text-align:center;display:flex;align-items:center;justify-content:center;min-height:50px;line-height:1.6;border-bottom:1px solid rgba(0,0,0,.1)}.dropdown-option[_ngcontent-%COMP%]:last-child{border-bottom:none}.dropdown-option[_ngcontent-%COMP%]:hover{background:#0000000d}.dropdown-option.selected[_ngcontent-%COMP%]{background:linear-gradient(135deg,#8b5cf6,#7c3aed)!important;color:#fff!important;font-weight:700}.level-text.level-beginner[_ngcontent-%COMP%]{color:#22c55e}.dropdown-option.selected[_ngcontent-%COMP%]   .level-text.level-beginner[_ngcontent-%COMP%]{color:#fff!important}.level-text.level-advanced[_ngcontent-%COMP%]{color:#f97316}.dropdown-option.selected[_ngcontent-%COMP%]   .level-text.level-advanced[_ngcontent-%COMP%]{color:#fff!important}.level-text.level-grand[_ngcontent-%COMP%]{color:#ef4444}.dropdown-option.selected[_ngcontent-%COMP%]   .level-text.level-grand[_ngcontent-%COMP%]{color:#fff!important}.dropdown-toggle[data-level=beginner][_ngcontent-%COMP%]   .level-text[_ngcontent-%COMP%]{color:#22c55e}.dropdown-toggle[data-level=advanced][_ngcontent-%COMP%]   .level-text[_ngcontent-%COMP%]{color:#f97316}.dropdown-toggle[data-level=grand][_ngcontent-%COMP%]   .level-text[_ngcontent-%COMP%]{color:#ef4444}.game-container[_ngcontent-%COMP%]{width:100%}.phase-header[_ngcontent-%COMP%]{text-align:center;margin-top:3vw;margin-bottom:clamp(16px,4vw,32px)}.phase-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:7vw;font-weight:800;color:#fff;margin:0 0 1.5vw;text-shadow:0 2px 4px rgba(0,0,0,.3)}.countdown[_ngcontent-%COMP%]{font-size:4.5vw;color:#ffffffe6;margin:0}.countdown[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:gold;font-size:5.5vw}.instruction-text[_ngcontent-%COMP%]{text-align:center;font-size:5.5vw;color:#fffc;margin:2.5vw 0}.pattern-grid[_ngcontent-%COMP%]{display:grid;gap:1.5vw;width:100%;max-width:min(400px,85vw);margin:0 auto clamp(20px,4vw,32px);padding:clamp(8px,2.5vw,16px);background:#0000004d;border-radius:clamp(10px,2.5vw,16px);backdrop-filter:blur(10px);box-sizing:border-box}.pattern-row[_ngcontent-%COMP%]{display:contents}.pattern-cell[_ngcontent-%COMP%]{aspect-ratio:1;width:100%;min-height:0;border-radius:clamp(6px,1.5vw,8px);border:clamp(2px,.5vw,3px) solid rgba(255,255,255,.2);transition:all .2s ease;display:flex;align-items:center;justify-content:center;position:relative;cursor:pointer;box-sizing:border-box}.pattern-cell[_ngcontent-%COMP%]:hover:not(.drop-zone){transform:scale(1.05);border-color:#fff6}.drop-zone[_ngcontent-%COMP%]{border:clamp(2px,.5vw,3px) dashed rgba(255,255,255,.3);user-select:none;-webkit-user-select:none;pointer-events:auto;cursor:default;transition:border-color .1s ease,border-width .1s ease,box-shadow .1s ease}.drop-zone.filled[_ngcontent-%COMP%]{border-style:solid;border-color:#fff6}.drop-zone.drag-over[_ngcontent-%COMP%]{border-color:gold!important;border-width:clamp(3px,.75vw,4px)!important;box-shadow:0 0 15px #ffd70066!important}.cell-number[_ngcontent-%COMP%]{font-size:4.5vw;color:#fff6;font-weight:700}.remove-hint[_ngcontent-%COMP%]{font-size:3.2vw;color:#fff9;text-align:center;padding:.75vw;display:none}.drop-zone.filled[_ngcontent-%COMP%]:hover   .remove-hint[_ngcontent-%COMP%]{display:block}.user-grid-container[_ngcontent-%COMP%]{margin-bottom:clamp(32px,5vw,48px)}.user-grid-container[_ngcontent-%COMP%]   .pattern-grid[_ngcontent-%COMP%]{max-width:min(320px,72vw)}.user-grid-container[_ngcontent-%COMP%]   .pattern-grid.grid-4-col[_ngcontent-%COMP%]{max-width:min(420px,82vw)}.grid-label[_ngcontent-%COMP%]{text-align:center;font-size:6vw;font-weight:700;color:#fff;margin-bottom:2.5vw;text-shadow:0 2px 4px rgba(0,0,0,.3)}.pieces-container[_ngcontent-%COMP%]{margin-top:clamp(24px,4vw,32px)}.pieces-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:2vw;justify-content:center;padding:clamp(16px,3vw,24px);background:#0000004d;border-radius:clamp(12px,2vw,16px);backdrop-filter:blur(10px);pointer-events:auto}.draggable-piece[_ngcontent-%COMP%]{width:clamp(40px,11vw,60px);height:clamp(40px,11vw,60px);min-width:40px;min-height:40px;flex-shrink:0;border-radius:clamp(8px,2vw,12px);border:clamp(2px,.5vw,3px) solid rgba(255,255,255,.3);cursor:grab;transition:all .2s ease;display:flex;align-items:center;justify-content:center;position:relative;box-shadow:0 4px 8px #0000004d;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-touch-callout:none;pointer-events:auto!important;touch-action:manipulation;box-sizing:border-box}.pieces-grid.grid-2-col[_ngcontent-%COMP%]   .draggable-piece[_ngcontent-%COMP%]{width:14.5vw!important;height:14.5vw!important;min-width:0!important;min-height:0!important}.draggable-piece[_ngcontent-%COMP%]:hover{transform:scale(1.1) translateY(-4px);border-color:#fff9;box-shadow:0 8px 16px #0006}.draggable-piece[_ngcontent-%COMP%]:active{cursor:grabbing!important;opacity:.8}.draggable-piece.press-hold[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pressHold .1s ease-out forwards}.draggable-piece[draggable=true][_ngcontent-%COMP%], .draggable-piece[draggable=true][_ngcontent-%COMP%]:hover{cursor:grab}.draggable-piece[draggable=true][_ngcontent-%COMP%]:active{cursor:grabbing!important}@keyframes _ngcontent-%COMP%_pressHold{0%{transform:scale(1)}50%{transform:scale(.95);border-color:#ffd700cc}to{transform:scale(1.05);border-color:gold;box-shadow:0 0 20px #ffd70080}}.piece-hint[_ngcontent-%COMP%]{font-size:3.2vw;color:#fffc;font-weight:700;text-shadow:0 1px 2px rgba(0,0,0,.5)}.completion-card[_ngcontent-%COMP%]{text-align:center;padding:6vw 4vw;background:#0006;border-radius:4vw;backdrop-filter:blur(10px);box-shadow:0 8px 32px #0000004d;max-width:min(600px,95vw);margin:0 auto;box-sizing:border-box}.completion-icon[_ngcontent-%COMP%]{font-size:15vw;margin-bottom:2.5vw}.completion-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:8.5vw;font-weight:800;color:#fff;margin:0 0 2.5vw;text-shadow:0 2px 4px rgba(0,0,0,.3)}.success-message[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%]{font-size:5vw;color:#ffffffe6;margin:0 0 5vw}.error-message[_ngcontent-%COMP%]{color:#ff6b6b}.score-display[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:5vw;margin:clamp(24px,4vw,32px) 0;padding:clamp(16px,3vw,24px);background:#ffffff1a;border-radius:clamp(12px,2vw,16px);flex-wrap:wrap}.score-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1vw}.score-label[_ngcontent-%COMP%]{font-size:5.5vw;color:#ffffffb3}.score-value[_ngcontent-%COMP%]{font-size:7.5vw;font-weight:800;color:gold;text-shadow:0 2px 4px rgba(0,0,0,.3)}.button-group[_ngcontent-%COMP%]{display:flex;gap:2.5vw;justify-content:center;margin-top:clamp(24px,5vw,32px);flex-wrap:wrap}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{padding:2.5vw 4vw;border:none;border-radius:2vw;font-size:4.5vw;font-weight:700;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 12px #0000004d;min-width:120px;flex:1 1 auto;max-width:300px;box-sizing:border-box}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#8b5cf6,#6d28d9);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #8b5cf680}.btn-secondary[_ngcontent-%COMP%]{background:#ffffff1a;color:#fff;border:2px solid rgba(255,255,255,.3)}.btn-secondary[_ngcontent-%COMP%]:hover{background:#fff3;transform:translateY(-2px)}@media (max-width: 480px){.pattern-grid[_ngcontent-%COMP%]{max-width:95vw;padding:2vw;gap:1vw}.pattern-cell[_ngcontent-%COMP%]{min-height:50px}.draggable-piece[_ngcontent-%COMP%]{width:18vw;height:18vw;min-width:50px;min-height:50px}.pieces-grid.grid-2-col[_ngcontent-%COMP%]   .draggable-piece[_ngcontent-%COMP%]{width:14.5vw!important;height:14.5vw!important;min-width:0!important;min-height:0!important}.score-display[_ngcontent-%COMP%]{flex-direction:column;gap:20px}.button-group[_ngcontent-%COMP%]{flex-direction:column}.button-group[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%], .button-group[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{width:100%;max-width:100%}}@media (min-width: 481px) and (max-width: 768px){.pattern-grid[_ngcontent-%COMP%]{max-width:min(350px,80vw)}.draggable-piece[_ngcontent-%COMP%]{width:9vw;height:9vw}.pieces-grid.grid-2-col[_ngcontent-%COMP%]   .draggable-piece[_ngcontent-%COMP%]{width:14.5vw!important;height:14.5vw!important}}@media (max-width: 768px) and (orientation: landscape){.phase-header[_ngcontent-%COMP%]{margin-bottom:2vh}.pattern-grid[_ngcontent-%COMP%]{max-width:min(300px,50vw);margin-bottom:2vh}.user-grid-container[_ngcontent-%COMP%]{margin-bottom:3vh}.pieces-container[_ngcontent-%COMP%]{margin-top:2vh}.completion-card[_ngcontent-%COMP%]{padding:3vh 2vw}}@media (min-width: 1200px){.content[_ngcontent-%COMP%]{max-width:900px}.pattern-grid[_ngcontent-%COMP%]{max-width:450px}.draggable-piece[_ngcontent-%COMP%]{width:60px;height:60px}}"]})}}return a})()}}]);